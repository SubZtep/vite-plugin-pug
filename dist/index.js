function isPug(filename){return filename.split("?")[0].split("#")[0].endsWith(".pug")}import{compileFile}from"pug";function PugPlugin(options,locals){return{name:"vite-plugin-pug",handleHotUpdate({file,server}){if(isPug(file)){server.config.logger.info(`pug\u2019s not hot \u{1F32D} ${file}`);server.ws.send({type:"full-reload"})}},transformIndexHtml:{transform(html,{server,filename:htmlfile}){return resolvePugTag(html,filename=>{const compile=filepath=>compileFile(filepath,options)(locals);if(typeof options?.localImports==="function"&&options.localImports(htmlfile)||options?.localImports){const filedir=htmlfile.replace(/(.*)[\\\/].*\.html$/,"$1");const filepath=`${filedir}/${filename}`;return compile(filepath)}return compile(filename)},server?.config.logger)}}}}var plugin_default=PugPlugin;function resolvePugTag(html,pugger,logger){return html.replace(/<pug.+?(file|src)="(.+?)".*?\/.*?>/gi,(_tag,attr,filename)=>{return pugger(filename)})}export{plugin_default as default,resolvePugTag as pugs};
